<main class="container">
  <div style="display: flex; justify-content: space-between; align-items: flex-start;">
    <hgroup>
      <h1><%= @document.title %></h1>
      <p>
        <%= link_to @document.entity.name, entity_path(@document.entity) %> • 
        FY <%= @document.fiscal_year %> • 
        <%= @document.doc_type.upcase %>
      </p>
    </hgroup>
    
    <% if user_signed_in? %>
      <div>
        <%= link_to "Update Document", edit_document_path(@document), role: "button", class: "secondary outline" %>
      </div>
    <% end %>
  </div>

  <hr />

  <div class="grid">
    <article>
      <header><strong>Access File</strong></header>
      
      <div style="margin-bottom: 20px;">
        <strong>Original Source:</strong><br>
          <% if @document.source_url.to_s.match?(/\Ahttps?:\/\//) %>
            <%= link_to @document.source_url, @document.source_url, target: "_blank", rel: "noopener" %>
        <% else %>
          <%= @document.source_url %> <small>(Link disabled for security)</small>
        <% end %>        
      </div>

      <% if @document.file.attached? %>
        <div>
          <strong>Archived Copy:</strong><br>
            <%= link_to "Download PDF", rails_blob_path(@document.file, disposition: "attachment"), role: "button", target: "_blank" %>
        </div>
      <% else %>
        <p><em>No local PDF archived.</em></p>
      <% end %>
    </article>

    <article>
      <header><strong>Notes</strong></header>
      <p><%= @document.notes.presence || "No notes added." %></p>
    </article>
  </div>
</main>