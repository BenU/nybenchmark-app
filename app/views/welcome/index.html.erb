<section class="landing-hero">
  <h1>NY Benchmark</h1>
  <p>Comparing financial health across New York's local governments</p>

  <div class="landing-stats">
    <div class="landing-stat">
      <span class="landing-stat-value"><%= Entity.where(kind: :city).count %></span>
      <span class="landing-stat-label">Cities</span>
    </div>
    <div class="landing-stat">
      <span class="landing-stat-value"><%= Entity.school_districts.count %></span>
      <span class="landing-stat-label">School Districts</span>
    </div>
    <div class="landing-stat">
      <span class="landing-stat-value"><%= Observation.distinct.count(:fiscal_year) %></span>
      <span class="landing-stat-label">Years of Data</span>
    </div>
    <div class="landing-stat">
      <span class="landing-stat-value"><%= number_with_delimiter(Observation.count / 1000) %>K+</span>
      <span class="landing-stat-label">Data Points</span>
    </div>
  </div>

  <div class="hero-buttons">
    <%= link_to "Explore Cities", entities_path, role: "button" %>
    <%= link_to "Compare School Districts", school_districts_compare_path, role: "button", class: "outline" %>
  </div>

  <% if @non_filer_count && @non_filer_count > 0 %>
    <p class="non-filer-callout">
      <%= @non_filer_count %> <%= @non_filer_count == 1 ? "city" : "cities" %>
      not included in the <%= @rankings_year %> rankings below due to late or missing filings.
      <%= link_to "View filing status", non_filers_path %>
    </p>
  <% end %>
</section>

<% if @fund_balance_ranking.present? || @debt_service_ranking.present? || @per_capita_ranking.present? %>
  <section>
    <hgroup>
      <h2>City Rankings</h2>
      <p>Based on FY <%= @rankings_year %> financial data</p>
    </hgroup>

    <div class="rankings-grid">
      <% if @fund_balance_ranking.present? %>
        <%= render "ranking_card",
              ranking: @fund_balance_ranking,
              title: "Fund Balance %",
              description: "Unassigned fund balance as a percentage of total expenditures. Higher is generally stronger.",
              format: :percentage %>
      <% end %>

      <% if @debt_service_ranking.present? %>
        <%= render "ranking_card",
              ranking: @debt_service_ranking,
              title: "Debt Service %",
              description: "Debt service as a percentage of total expenditures. Lower typically indicates less debt burden.",
              format: :percentage %>
      <% end %>

      <% if @per_capita_ranking.present? %>
        <%= render "ranking_card",
              ranking: @per_capita_ranking,
              title: "Per-Capita Spending",
              description: "Total expenditures divided by population.",
              format: :currency %>
      <% end %>
    </div>
  </section>
<% end %>

<article>
  <header><h3>About</h3></header>
  <p>
    Nonpartisan, evidence-based analysis of governance and financial data across New York State's cities and school districts.
    All data sourced from official filings and public records.
  </p>
  <div class="grid">
    <a href="https://nybenchmark.org">&larr; Project Website</a>
    <%= link_to "Methodology â†’", methodology_path %>
  </div>
</article>
